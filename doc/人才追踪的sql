--人才追踪的申请注册人才卡
INSERT into datav.t_track (track_time,track_type,track_node,track_content)  
SELECT create_time as track_time,1 as track_type ,1 as track_node ,CONCAT(name,'申请注册人才卡') as track_content FROM talentcard.`t_talent` WHERE create_time is not NULL;

--人才追踪的提交认证信息
INSERT into datav.t_track (track_time,track_type,track_node,track_content) 
SELECT cp.create_time as track_time,1 as track_type ,2 as track_node ,CONCAT(name,'提交认证信息') 
	from talentcard.t_cert_approval as cp LEFT JOIN talentcard.t_certification as c on cp.cert_id=c.cert_id
			LEFT JOIN talentcard.t_talent as t on c.talent_id=t.talent_id 
  WHERE cp.type=1 

--提交认证信息，已通过审批

INSERT into datav.t_track (track_time,track_type,track_node,track_content) 
SELECT cp.create_time as track_time,1 as track_type ,2 as track_node ,CONCAT(name,'提交认证信息，已通过审批') 
	from talentcard.t_cert_approval as cp LEFT JOIN talentcard.t_certification as c on cp.cert_id=c.cert_id
			LEFT JOIN talentcard.t_talent as t on c.talent_id=t.talent_id 
  WHERE cp.type=2 and  cp.result=1
  
--提交认证信息，被驳回

INSERT into datav.t_track (track_time,track_type,track_node,track_content) 
SELECT cp.create_time as track_time,1 as track_type ,2 as track_node ,CONCAT(name,'提交认证信息，被驳回') 
	from talentcard.t_cert_approval as cp LEFT JOIN talentcard.t_certification as c on cp.cert_id=c.cert_id
			LEFT JOIN talentcard.t_talent as t on c.talent_id=t.talent_id 
  WHERE cp.type=2 and  cp.result=2
  
--汇总的sql
   INSERT into datav.t_track (track_time,track_type,track_node,track_content)  
( 
SELECT create_time as track_time,1 as track_type ,1 as track_node ,CONCAT(name,'申请注册人才卡') as track_content FROM talentcard.`t_talent` WHERE create_time is not NULL
   UNION 
SELECT cp.create_time as track_time,1 as track_type ,2 as track_node ,CONCAT(name,'提交认证信息') 
	from talentcard.t_cert_approval as cp LEFT JOIN talentcard.t_certification as c on cp.cert_id=c.cert_id
			LEFT JOIN talentcard.t_talent as t on c.talent_id=t.talent_id 
  WHERE cp.type=1
 union
SELECT cp.create_time as track_time,1 as track_type ,2 as track_node ,CONCAT(name,'提交认证信息，已通过审批') 
	from talentcard.t_cert_approval as cp LEFT JOIN talentcard.t_certification as c on cp.cert_id=c.cert_id
			LEFT JOIN talentcard.t_talent as t on c.talent_id=t.talent_id 
  WHERE cp.type=2 and  cp.result=1
 UNION
SELECT cp.create_time as track_time,1 as track_type ,2 as track_node ,CONCAT(name,'提交认证信息，被驳回') 
	from talentcard.t_cert_approval as cp LEFT JOIN talentcard.t_certification as c on cp.cert_id=c.cert_id
			LEFT JOIN talentcard.t_talent as t on c.talent_id=t.talent_id 
  WHERE cp.type=2 and  cp.result=2
ORDER BY track_time ASC
)